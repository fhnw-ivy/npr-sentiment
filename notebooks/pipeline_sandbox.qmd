---
title: Pipeline Sandbox
jupyter: python3
---

```{python}
from dotenv import load_dotenv
import os
import sys
import pandas as pd

load_dotenv()

current_dir = os.getcwd()
parent_dir = os.path.dirname(current_dir)
sys.path.append(parent_dir)

from src.data_loader import load_datasets
from src.weaklabel_pipeline import WeakLabelingPipeline

DATA_DIR = os.getenv('DATA_DIR')
```

This notebook contains an example showing the usage of `WeakLabelingPipeline`.


```{python}
labelled_dev, unlabelled_dev, val_set = load_datasets(DATA_DIR)
df = unlabelled_dev
```

## Pipeline usage

```{python}
wl_pipeline = WeakLabelingPipeline('wl_knn.pkl')
wl_pipeline.run(df)
wl_pipeline.save_results('weaklabeled_knn_dev.parquet')
```

```{python}

df_weaklabeled = pd.read_parquet(f'{DATA_DIR}/weaklabeled_knn_dev.parquet')
df_weaklabeled.head(5)
```

